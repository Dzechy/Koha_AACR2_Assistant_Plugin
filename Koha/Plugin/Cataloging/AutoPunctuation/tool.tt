[% INCLUDE 'doc-head-open.inc' %]
<title>Koha: AACR2 MARC21 LCC Intellisense</title>
[% INCLUDE 'doc-head-close.inc' %]
[% INCLUDE 'calendar.inc' %]
<style>
    .configuration-section {
        background: #f9f9f9;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-bottom: 20px;
    }
    .configuration-section legend {
        background: #337ab7;
        color: white;
        padding: 5px 15px;
        border-radius: 4px 4px 0 0;
        margin: 0;
        width: 100%;
        font-size: 14px;
    }
    .configuration-section .rows {
        padding: 15px;
        margin: 0;
    }
    .hint {
        color: #666;
        font-size: 0.9em;
        font-style: italic;
        display: block;
        margin-top: 3px;
    }
    .alert-success {
        background: #dff0d8;
        border: 1px solid #d6e9c6;
        color: #3c763d;
        padding: 10px;
        border-radius: 4px;
    }
    .label-success {
        background-color: #5cb85c;
        color: white;
        padding: 2px 6px;
        border-radius: 3px;
        font-weight: bold;
    }
    .label-danger {
        background-color: #d9534f;
        color: white;
        padding: 2px 6px;
        border-radius: 3px;
        font-weight: bold;
    }
    .label-warning {
        background-color: #f0ad4e;
        color: white;
        padding: 2px 6px;
        border-radius: 3px;
        font-weight: bold;
    }
    .label-default {
        background-color: #777;
        color: white;
        padding: 2px 6px;
        border-radius: 3px;
        font-weight: bold;
    }
    .field-table {
        width: 100%;
        margin-bottom: 20px;
        border-collapse: collapse;
        background: #fff;
        border: 1px solid #ddd;
    }
    .field-table th, .field-table td {
        padding: 8px 12px;
        font-size: 14px;
        color: #333;
        border: 1px solid #ddd;
    }
    .field-table th {
        background: #f9f9f9;
        font-weight: bold;
    }
    .punctuation-field-example {
        font-family: monospace;
        background: #f9f9f9;
        padding: 3px 6px;
        border: 1px solid #ddd;
        border-radius: 3px;
    }
    .action {
        margin-top: 15px;
    }
    .action .btn {
        margin-right: 8px;
    }
    dl {
        margin-bottom: 15px;
    }
    dt {
        font-weight: bold;
        color: #333;
        margin-bottom: 5px;
    }
    dd {
        color: #333;
        margin-bottom: 10px;
        margin-left: 20px;
    }
    .warning-text {
        color: red;
        font-weight: bold;
    }
</style>
</head>
<body>
[% INCLUDE 'header.inc' %]
[% INCLUDE 'cat-search.inc' %]
<div id="breadcrumbs">
    <div class="container">
        <a href="/cgi-bin/koha/mainpage.pl">Home</a> ⁄
        <a href="/cgi-bin/koha/plugins/plugins-home.pl">Plugins</a> ⁄
        <span class="active">AACR2 MARC21 LCC Intellisense</span>
    </div>
</div>
<div class="main container-fluid">
    <div class="row">
        <div class="col-sm-10 col-sm-push-2">
            <main>
                <h1>AACR2 MARC21 LCC Intellisense</h1>

                [% IF settings.last_updated %]
                <div class="alert alert-success">
                    <p><i class="fa fa-check-circle"></i> Last configuration update: [% settings.last_updated %]</p>
                </div>
                [% END %]

                <div class="row">
                    <div class="col-sm-6">
                        <fieldset class="configuration-section">
                            <legend>Plugin Status</legend>
                            <div class="rows">
                                <dl>
                                    <dt>Auto-Punctuation</dt>
                                    <dd>
                                        [% IF settings.enabled %]
                                            <span class="label label-success">Enabled</span>
                                        [% ELSE %]
                                            <span class="label label-danger">Disabled</span>
                                        [% END %]
                                    </dd>
                                    <dt>Cataloging Standard</dt>
                                    <dd>AACR2 (MARC21 · LCC)</dd>
                                    <dt>Debug Mode</dt>
                                    <dd>
                                        [% IF settings.debug_mode %]
                                            <span class="label label-warning">Enabled</span>
                                        [% ELSE %]
                                            <span class="label label-default">Disabled</span>
                                        [% END %]
                                    </dd>
                                    <dt>Interactive Guide</dt>
                                    <dd>
                                        [% IF settings.enable_guide %]
                                            <span class="label label-success">Enabled</span>
                                        [% ELSE %]
                                            <span class="label label-danger">Disabled</span>
                                        [% END %]
                                    </dd>
                                    <dt>Internship Mode</dt>
                                    <dd>
                                        [% IF settings.internship_mode %]
                                            <span class="label label-success">Enabled</span>
                                        [% ELSE %]
                                            <span class="label label-danger">Disabled</span>
                                        [% END %]
                                    </dd>
                                    <dt>AACR2 Guardrails</dt>
                                    <dd>
                                        [% IF settings.enforce_aacr2_guardrails %]
                                            <span class="label label-success">Enforced</span>
                                        [% ELSE %]
                                            <span class="label label-default">Soft</span>
                                        [% END %]
                                    </dd>
                                    <dt>Live Validation</dt>
                                    <dd>
                                        [% IF settings.enable_live_validation %]
                                            <span class="label label-warning">On</span>
                                        [% ELSE %]
                                            <span class="label label-default">Off</span>
                                        [% END %]
                                    </dd>
                                    <dt>AI Classification</dt>
                                    <dd>
                                        [% IF settings.llm_api_key %]
                                            <span class="label label-success">Enabled</span>
                                        [% ELSE %]
                                            <span class="label label-danger">Disabled</span>
                                        [% END %]
                                    </dd>
                                    [% IF settings.last_updated %]
                                    <dt>Last Updated</dt>
                                    <dd>[% settings.last_updated %]</dd>
                                    [% END %]
                                </dl>
                                <div class="action">
                                    <a href="/cgi-bin/koha/plugins/run.pl?class=[% CLASS %]&method=configure" class="btn btn-primary">
                                        <i class="fa fa-cog"></i> Configure Plugin
                                    </a>
                                    <a href="/cgi-bin/koha/plugins/plugins-home.pl" class="btn btn-default">
                                        <i class="fa fa-arrow-left"></i> Back to Plugins
                                    </a>
                                </div>
                            </div>
                        </fieldset>
                    </div>

                    <div class="col-sm-6">
                        <fieldset class="configuration-section">
                            <legend>How to Use</legend>
                            <div class="rows">
                                <p>This plugin automatically inserts standard punctuation marks in bibliographic fields during cataloging.</p>
                                <span class="hint">Use this tool to streamline cataloging according to AACR2-only MARC21 practice.</span>
                                <p>Key features:</p>
                                <ul>
                                    <li>AACR2-only punctuation guardrails</li>
                                    <li>Adds prefix punctuation on field entry</li>
                                    <li>Adds suffix punctuation on field exit</li>
                                    <li>Handles field relationships (e.g., 245$a adjusts based on $b, $c)</li>
                                    <li>Toggle on/off during cataloging</li>
                                    <li>Intern and exclusion lists for controlled training</li>
                                    <li>Live validation that blocks save when violations remain (optional)</li>
                                    <li>Interactive guide for training</li>
                                    <li>AI-driven subject and LCC classification insertion</li>
                                </ul>
                                <p>To try it, <a href="/cgi-bin/koha/cataloguing/addbiblio.pl?frameworkcode=">create a new bibliographic record</a>.</p>
                                <span class="hint">Click the link above to start cataloging with automatic punctuation.</span>
                            </div>
                        </fieldset>
                    </div>
                </div>

                <fieldset class="configuration-section">
                    <legend>Supported Fields</legend>
                    <div class="rows">
                        <p>The plugin supports multiple MARC21 fields. Below are common examples:</p>
                        <span class="hint">These examples show how punctuation is applied based on the selected cataloging standard.</span>

                        <h3>Title Fields (245)</h3>
                        <table class="field-table table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th>Field</th>
                                    <th>Punctuation</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>245$a</td>
                                    <td>Ends with period (.) if no subsequent subfields</td>
                                    <td><span class="punctuation-field-example">$aThe great Gatsby.</span></td>
                                </tr>
                                <tr>
                                    <td>245$b</td>
                                    <td>Preceded by colon and space ( : )</td>
                                    <td><span class="punctuation-field-example">$aThe great Gatsby :$ba novel</span></td>
                                </tr>
                                <tr>
                                    <td>245$c</td>
                                    <td>Preceded by slash and space ( / )</td>
                                    <td><span class="punctuation-field-example">$aThe great Gatsby /$cF. Scott Fitzgerald.</span></td>
                                </tr>
                            </tbody>
                        </table>

                        <h3>Publication Fields (260/264)</h3>
                        <table class="field-table table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th>Field</th>
                                    <th>Punctuation</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>260$a</td>
                                    <td>Ends with colon ( : )</td>
                                    <td><span class="punctuation-field-example">$aNew York :</span></td>
                                </tr>
                                <tr>
                                    <td>260$b</td>
                                    <td>Ends with comma ( , )</td>
                                    <td><span class="punctuation-field-example">$bScribner,</span></td>
                                </tr>
                                <tr>
                                    <td>260$c</td>
                                    <td>Ends with period ( . )</td>
                                    <td><span class="punctuation-field-example">$c1925.</span></td>
                                </tr>
                            </tbody>
                        </table>

                        <h3>Physical Description Fields (300)</h3>
                        <table class="field-table table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th>Field</th>
                                    <th>Punctuation</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>300$a</td>
                                    <td>Ends with colon ( : ) if $b follows, period ( . ) otherwise</td>
                                    <td><span class="punctuation-field-example">$a180 pages :</span></td>
                                </tr>
                                <tr>
                                    <td>300$b</td>
                                    <td>Ends with semicolon ( ; )</td>
                                    <td><span class="punctuation-field-example">$billustrations ;</span></td>
                                </tr>
                                <tr>
                                    <td>300$c</td>
                                    <td>Ends with period ( . )</td>
                                    <td><span class="punctuation-field-example">$c23 cm.</span></td>
                                </tr>
                            </tbody>
                        </table>

                        <p>Other supported fields include 1XX/7XX (names), 5XX (notes), 6XX (subjects), and RDA fields (336–338).</p>
                        <span class="hint">Refer to the plugin configuration to customize punctuation rules for additional fields.</span>
                    </div>
                </fieldset>

                <fieldset class="configuration-section">
                    <legend>Troubleshooting</legend>
                    <div class="rows">
                        <p>If you encounter issues with the plugin:</p>
                        <ul>
                            <li>Ensure the plugin is enabled in the configuration settings.</li>
                            <li>Check the cataloging standard (AACR2/RDA) matches your needs.</li>
                            <li>Manually edit fields if automatic punctuation is incorrect.</li>
                            <li>Toggle auto-punctuation off for specific records if needed.</li>
                            <li>Verify your OpenAI API key for AI classification features.</li>
                            <li>Enable debug mode to view console logs for troubleshooting.</li>
                            <li>Contact your system administrator for configuration issues.</li>
                        </ul>
                        <p>If problems persist, check the Koha logs or reinstall the plugin.</p>
                        <span class="hint">Debug mode can be enabled in the configuration settings to provide detailed error information.</span>
                    </div>
                </fieldset>

            </main>
        </div>

        <div class="col-sm-2 col-sm-pull-10">
            <aside>
                [% INCLUDE 'tools-menu.inc' %]
            </aside>
        </div>
    </div>
</div>
[% INCLUDE 'intranet-bottom.inc' %]

